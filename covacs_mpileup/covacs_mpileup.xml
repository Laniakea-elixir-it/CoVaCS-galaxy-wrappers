 <tool id="covacs_mpileup" name="covacs_mpileup" version="1.9">
  <description>mpileup for covacs</description>
  <macros>
	<import>bed_macros.xml</import>
	<import>covacs_macros.xml</import>
  </macros>
  <requirements>
  	<requirement type="package" version="1.9" >samtools</requirement>
  </requirements>
  <command>
    <![CDATA[


       samtools mpileup 
	 -C $adjust 
	#if $bed_source.bed_source_selector == "history"
	  -l $bed_source.bed_history
	  #end if
  	  #if $bed_source.bed_source_selector == "cached"
   	  -l $bed_source.bed_cached.fields.path
    	 #end if

	-d $depth
	-q $MappingQuality
	-Q $BaseQuality
	#if $reference_source.reference_source_selector == "cached"
                -f $reference_source.ref_file.fields.path
        #end if
	
	#if $reference_source.reference_source_selector == "history"
	
         -f $reference_source.ref_file_h
	
	#end if

	$input1 -A -o $output 2>$log

	



	]]>
  </command>
  <inputs>
    <param format="bam" name="input1" label="bam-input" type="data" optional="true" />
    <param name="adjust" type="text" optional="true" value="50" />
    <expand macro="bed_loc"/>
    <param name="depth" type="text" optional="true" value="100000" />
    <param name="MappingQuality" type="text" optional="true" value="0" />
    <param name="BaseQuality" type="text" optional="true" value="0" />
    <expand macro="reference_loc"/>
  </inputs>
  <outputs>
    <data format="pileup" name="output" label="mpileup on ${on_string}"/>
    <data format="txt" name="log" label="mpileup on ${on_string}:log"/>
  </outputs>
  <help>
  </help>
  <citations>
  </citations>
</tool>

